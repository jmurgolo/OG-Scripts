import re
import os

# Step 1: Define the output directory name
output_directory = "building ticket"  # You can change this name here

# Step 2: Create the output directory if it doesn't exist
if not os.path.exists(output_directory):
    os.makedirs(output_directory)
    print(f"Created directory: '{output_directory}'")

# Step 3: Define the mapping sections
mapping_text = """
# First Ticket to Second Ticket
FF1028778 = FF1028807
FF1028777 = FF1028806
FF1028762 = FF1028791
FF1028737 = FF1028763
FF1028738 = FF1028766
FF1028739 = FF1028767
FF1028741 = FF1028768
FF1028751 = FF1028780
FF1028752 = FF1028781
FF1028753 = FF1028777
FF1028754 = FF1028783
FF1028755 = FF1028784
FF1028757 = FF1028785
FF1028749 = FF1028778
FF1028761 = FF1028790
FF1028748 = FF1028777
FF1031246 = FF1031247
OL1029024 = OL1029061
FIRST NOTICE OF VIOLATIONS = SECOND NOTICE OF VIOLATIONS
FF1029058 = FF1029062
FF1029059 = FF1029063
FIRST STOP WORK NOTICE = SECOND STOP WORK NOTICE
FF1026233 = FF1026234
FF1026252 = FF1026251
FF1026282 = FF1026284
FF1026518 = FF1026521
FIRST VIOLATION TICKET = SECOND VIOLATION TICKET

# Second Ticket to Third Ticket
FF1028807 = FF1028836
FF1028806 = FF1028835
FF1028791 = FF1028820
FF1028763 = FF1028792
FF1028766 = FF1028795
FF1028767 = FF1028796
FF1028768 = FF1028797
FF1028770 = FF1028799
FF1028809 = FF1028838
FF1028810 = FF1028839
FF1028811 = FF1028840
FF1028812 = FF1028841
FF1028813 = FF1028842
FF1028814 = FF1028843
FF1028807 = FF1028836
FF1028819 = FF1028848
FF1028806 = FF1028835
FF1031247 = FF1031248
OL1029061 = OL1029065
SECOND NOTICE OF VIOLATIONS = THIRD NOTICE OF VIOLATIONS
FF1029062 = FF1029067
FF1029063 = FF1029066
SECOND STOP WORK NOTICE = THIRD STOP WORK NOTICE
FF1026234 = FF1026235
FF1026251 = FF1026250
FF1026284 = FF1026285
FF1026521 = FF1026517
SECOND VIOLATION TICKET = THIRD VIOLATION TICKET

# Third Ticket to Fourth Ticket
FF1028836 = FF1028865
FF1028835 = FF1028864
FF1028820 = FF1028849
FF1028792 = FF1028821
FF1028795 = FF1028824
FF1028796 = FF1028825
FF1028797 = FF1028826
FF1028799 = FF1028828
FF1028838 = FF1028867
FF1028839 = FF1028868
FF1028840 = FF1028869
FF1028841 = FF1028870
FF1028842 = FF1028871
FF1028843 = FF1028872
FF1028836 = FF1028865
FF1028848 = FF1028877
FF1028835 = FF1028864
FF1031248 = FF1031249
OL1029065 = OL1029069
THIRD NOTICE OF VIOLATIONS = FOURTH NOTICE OF VIOLATIONS
FF1029067 = FF1029070
FF1029066 = FF1029071
THIRD STOP WORK NOTICE = FOURTH STOP WORK NOTICE
FF1026235 = FF1026236
FF1026250 = FF1026249
FF1026285 = FF1026283
FF1026517 = FF1026519
THIRD VIOLATION TICKET = FOURTH VIOLATION TICKET

# Fourth Ticket to Fifth Ticket
FF1028865 = FF1028894
FF1028864 = FF1028893
FF1028849 = FF1028878
FF1028821 = FF1028850
FF1028824 = FF1028853
FF1028825 = FF1028854
FF1028826 = FF1028855
FF1028828 = FF1028857
FF1028838 = FF1028867
FF1028839 = FF1028868
FF1028840 = FF1028869
FF1028841 = FF1028870
FF1028842 = FF1028871
FF1028843 = FF1028872
FF1028836 = FF1028865
FF1028848 = FF1028877
FF1028835 = FF1028864
FF1031249 = FF1031245
OL1029069 = OL1029073
FOURTH NOTICE OF VIOLATIONS = FIFTH NOTICE OF VIOLATIONS
FF1029070 = FF1029074
FF1029071 = FF1029075
FOURTH STOP WORK NOTICE = FIFTH STOP WORK NOTICE
FF1026236 = FF1026237
FF1026249 = FF1026248
FF1026283 = FF1026286
FF1026519 = FF1026522
FOURTH VIOLATION TICKET = FIFTH VIOLATION TICKET

# Fifth Ticket to Sixth Ticket
FF1028894 = FF1028923
FF1028893 = FF1028922
FF1028878 = FF1028907
FF1028850 = FF1028879
FF1028853 = FF1028882
FF1028854 = FF1028883
FF1028855 = FF1028884
FF1028857 = FF1028886
FF1028867 = FF1028896
FF1028868 = FF1028897
FF1028869 = FF1028898
FF1028870 = FF1028899
FF1028871 = FF1028900
FF1028872 = FF1028901
FF1028865 = FF1028894
FF1028877 = FF1028906
FF1028864 = FF1028893
FF1031245 = FF1031250
OL1029073 = OL1029077
FIFTH NOTICE OF VIOLATIONS = SIXTH NOTICE OF VIOLATIONS
FF1029074 = FF1029078
FF1029075 = FF1029079
FIFTH STOP WORK NOTICE = SIXTH STOP WORK NOTICE
FF1026237 = FF1026238
FF1026248 = FF1026247
FF1026286 = FF1026287
FF1026522 = FF1026523
FIFTH VIOLATION TICKET = SIXTH VIOLATION TICKET

# Sixth Ticket to Seventh Ticket
FF1028923 = FF1028952
FF1028922 = FF1028951
FF1028907 = FF1028936
FF1028879 = FF1028908
FF1028882 = FF1028911
FF1028883 = FF1028912
FF1028884 = FF1028913
FF1028886 = FF1028915
FF1028896 = FF1028925
FF1028897 = FF1028926
FF1028898 = FF1028927
FF1028899 = FF1028928
FF1028900 = FF1028929
FF1028901 = FF1028930
FF1028894 = FF1028923
FF1028906 = FF1028935
FF1028893 = FF1028922
FF1031250 = FF1031251
OL1029077 = OL1029081
SIXTH NOTICE OF VIOLATIONS = SEVENTH NOTICE OF VIOLATIONS
FF1029078 = FF1029082
FF1029079 = FF1029083
SIXTH STOP WORK NOTICE = SEVENTH STOP WORK NOTICE
FF1026238 = FF1026239
FF1026247 = FF1026246
FF1026287 = FF1026288
FF1026523 = FF1026524
SIXTH VIOLATION TICKET = SEVENTH VIOLATION TICKET

# Seventh Ticket to Eighth Ticket
FF1028952 = FF1028981
FF1028951 = FF1028980
FF1028936 = FF1028965
FF1028908 = FF1028937
FF1028911 = FF1028940
FF1028912 = FF1028941
FF1028913 = FF1028942
FF1028915 = FF1028944
FF1028925 = FF1028954
FF1028926 = FF1028955
FF1028927 = FF1028956
FF1028928 = FF1028957
FF1028929 = FF1028958
FF1028930 = FF1028959
FF1028923 = FF1028952
FF1028935 = FF1028964
FF1028893 = FF1028951
FF1031251 = FF1031253
OL1029081 = OL1029085
SEVENTH NOTICE OF VIOLATIONS = EIGHTH NOTICE OF VIOLATIONS
FF1029082 = FF1029086
FF1029083 = FF1029087
SEVENTH STOP WORK NOTICE = EIGHTH STOP WORK NOTICE
FF1026239 = FF1026240
FF1026246 = FF1026245
FF1026288 = FF1026289
FF1026524 = FF1026525
SEVENTH VIOLATION TICKET = EIGHTH VIOLATION TICKET

# Eighth Ticket to Ninth Ticket
FF1028981 = FF1029010
FF1028980 = FF1029009
FF1028965 = FF1028994
FF1028937 = FF1028966
FF1028940 = FF1028969
FF1028941 = FF1028970
FF1028942 = FF1028971
FF1028944 = FF1028973
FF1028954 = FF1028983
FF1028955 = FF1028984
FF1028956 = FF1028985
FF1028957 = FF1028986
FF1028958 = FF1028987
FF1028959 = FF1028988
FF1028952 = FF1028981
FF1028964 = FF1028993
FF1028951 = FF1028980
FF1031253 = FF1031254
OL1029085 = OL1029089
EIGHTH NOTICE OF VIOLATIONS = NINTH NOTICE OF VIOLATIONS
FF1029086 = FF1029090
FF1029087 = FF1029091
EIGHTH STOP WORK NOTICE = NINTH STOP WORK NOTICE
FF1026240 = FF1026241
FF1026245 = FF1026244
FF1026289 = FF1026290
FF1026525 = FF1026526
EIGHTH VIOLATION TICKET = NINTH VIOLATION TICKET

# Ninth Ticket to Tenth Ticket
FF1029010 = FF1029039
FF1029009 = FF1029038
FF1028994 = FF1029023
FF1028966 = FF1028995
FF1028969 = FF1028998
FF1028970 = FF1028999
FF1028971 = FF1029000
FF1028973 = FF1029002
FF1028983 = FF1029012
FF1028984 = FF1029013
FF1028985 = FF1029014
FF1028986 = FF1029015
FF1028987 = FF1029016
FF1028988 = FF1029017
FF1028981 = FF1029010
FF1028993 = FF1029022
FF1028980 = FF1029009
FF1031254 = FF1031252
OL1029089 = OL1029093
NINTH NOTICE OF VIOLATIONS = TENTH NOTICE OF VIOLATIONS
FF1029090 = FF1029094
FF1029091 = FF1029095
NINTH STOP WORK NOTICE = TENTH STOP WORK NOTICE
FF1026241 = FF1026242
FF1026244 = FF1026243
FF1026290 = FF1026291
FF1026526 = FF1026527
NINTH VIOLATION TICKET = TENTH VIOLATION TICKET
"""

# Step 4: Parse the mappings into an ordered list of dictionaries
mappings = []
current_mapping = {}
for line in mapping_text.strip().splitlines():
    line = line.strip()
    if line.startswith('#'):
        if current_mapping:
            mappings.append(current_mapping.copy())
            current_mapping = {}
        continue
    parts = line.split('=')
    if len(parts) == 2:
        left = parts[0].strip().replace('\u200b', '')
        right = parts[1].strip().replace('\u200b', '')
        current_mapping[left] = right
if current_mapping:
    mappings.append(current_mapping.copy())

# Step 5: Load input from a separate file
with open('find and replace input.txt', 'r', encoding='utf-8') as f:
    input_text = f.read()

# Step 6: Function to replace tokens
def replace_tokens(text, mapping):
    pattern = re.compile('|'.join(re.escape(k) for k in sorted(mapping, key=len, reverse=True)))
    return pattern.sub(lambda match: mapping.get(match.group(0), match.group(0)), text)

# Step 7: Define output filenames
output_filenames = [
    "letter_version_second.txt",
    "letter_version_third.txt",
    "letter_version_fourth.txt",
    "letter_version_fifth.txt",
    "letter_version_sixth.txt",
    "letter_version_seventh.txt",
    "letter_version_eighth.txt",
    "letter_version_ninth.txt",
    "letter_version_tenth.txt",
]

# Step 8: Perform sequential replacements and generate output files
current_text = input_text
for i, mapping in enumerate(mappings):
    current_text = replace_tokens(current_text, mapping)
    output_path = os.path.join(output_directory, output_filenames[i])
    with open(output_path, 'w', encoding='utf-8') as f:
        f.write(current_text)
    print(f"Generated: '{output_path}' after applying the '{mapping_text.strip().splitlines()[i*12]}' mapping") # Added mapping name for clarity

print(f"Done. Ten versions of the letter have been generated in the '{output_directory}' directory.")