import re
import os

# Step 1: Define the output directory name
output_directory = "pl and gas stop work"  # You can change this name here

# Step 2: Create the output directory if it doesn't exist
if not os.path.exists(output_directory):
    os.makedirs(output_directory)
    print(f"Created directory: '{output_directory}'")

# Step 3: Define the mapping sections
mapping_text = """
# first to second
FF1023398 = FF1023414
FF1023415 = FF1023431
FF1023327 = FF1023330
FF1023378 = FF1023394
FF1023382 = FF1023398
FF1023379 = FF1023395
FF1023380 = FF1023396
FF1023391 = FF1023407
FF1023390 = FF1023406
FF1038231 = FF1038228
FF1023329 = FF1023332
FF1023328 = FF1023331
FF1023385 = FF1023401
FF1023386 = FF1023402
FF1023387 = FF1023403
FF1023392 = FF1023408
FF1023456 = FF1023472
FF1023538 = FF1023539
FF1023549 = FF1023550
FF1023388 = FF1023404
MES1012220 = MES1012223
OL1023536 = OL1023562
FF1023560 = FF1023564
FF1023561 = FF1023565
FF1023559 = FF1023563
FF1023399 = FF1023415
FIRST NOTICE OF VIOLATIONS = SECOND NOTICE OF VIOLATIONS
FIRST VIOLATION TICKET = SECOND VIOLATION TICKET
FIRST NOTICE = SECOND NOTICE
FIRST STOP WORK NOTICE = SECOND STOP WORK NOTICE

# second to third
FF1023414 = FF1023430
FF1023431 = FF1023447
FF1023394 = FF1023410
FF1023398 = FF1023414
FF1023395 = FF1023411
FF1023396 = FF1023412
FF1023407 = FF1023423
FF1023406 = FF1023422
FF1038228 = FF1038230
FF1023401 = FF1023417
FF1023402 = FF1023418
FF1023403 = FF1023419
FF1023408 = FF1023424
FF1023472 = FF1023488
FF1023539 = FF1023540
FF1023550 = FF1023551
FF1023404 = FF1023420
MES1012223 = MES1012225
OL1023562 = OL1023566
FF1023564 = FF1023567
FF1023565 = FF1023569
FF1023563 = FF1023568
FF1023415 = FF1023431
SECOND NOTICE OF VIOLATIONS = THIRD NOTICE OF VIOLATIONS
SECOND VIOLATION TICKET = THIRD VIOLATION TICKET
SECOND NOTICE = THIRD NOTICE
SECOND STOP WORK NOTICE = THIRD STOP WORK NOTICE
# third to fourth
FF1023430 = FF1023446
FF1023447 = FF1023463
FF1023410 = FF1023426
FF1023414 = FF1023430
FF1023411 = FF1023427
FF1023412 = FF1023428
FF1023423 = FF1023439
FF1023422 = FF1023438
FF1038230 = FF1038232
FF1023417 = FF1023433
FF1023418 = FF1023434
FF1023419 = FF1023435
FF1023424 = FF1023440
FF1023488 = FF1023504
FF1023540 = FF1023541
FF1023551 = FF1023552
FF1023420 = FF1023436
MES1012225 = MES1012227
OL1023566 = OL1023570
FF1023567 = FF1023572
FF1023569 = FF1023573
FF1023568 = FF1023571
FF1023431 = FF1023447
THIRD NOTICE OF VIOLATIONS = FOURTH NOTICE OF VIOLATIONS
THIRD VIOLATION TICKET = FOURTH VIOLATION TICKET
THIRD NOTICE = FOURTH NOTICE
THIRD STOP WORK NOTICE = FOURTH STOP WORK NOTICE

# fourth to fifth
FF1023446 = FF1023462
FF1023463 = FF1023479
FF1023426 = FF1023442
FF1023430 = FF1023446
FF1023427 = FF1023443
FF1023428 = FF1023444
FF1023439 = FF1023455
FF1023438 = FF1023454
FF1038232 = FF1038229
FF1023433 = FF1023449
FF1023434 = FF1023450
FF1023435 = FF1023451
FF1023504 = FF1023520
FF1023541 = FF1023542
FF1023552 = FF1023553
FF1023436 = FF1023452
MES1012227 = MES1012229
OL1023570 = OL1023574
FF1023572 = FF1023576
FF1023573 = FF1023577
FF1023571 = FF1023575
FF1023447 = FF1023463
FOURTH NOTICE OF VIOLATIONS = FIFTH NOTICE OF VIOLATIONS
FOURTH VIOLATION TICKET = FIFTH VIOLATION TICKET
FOURTH NOTICE = FIFTH NOTICE
FOURTH STOP WORK NOTICE = FIFTH STOP WORK NOTICE

# fifth to sixth
FF1023462 = FF1023478
FF1023479 = FF1023495
FF1023442 = FF1023458
FF1023446 = FF1023462
FF1023443 = FF1023459
FF1023444 = FF1023460
FF1023455 = FF1023471
FF1023454 = FF1023470
FF1038229 = FF1038233
FF1023449 = FF1023465
FF1023450 = FF1023466
FF1023451 = FF1023467
FF1023542 = FF1023543
FF1023553 = FF1023554
FF1023452 = FF1023468
MES1012229 = MES1012231
OL1023574 = OL1023578
FF1023576 = FF1023580
FF1023577 = FF1023581
FF1023575 = FF1023579
FF1023463 = FF1023479
FIFTH NOTICE OF VIOLATIONS = SIXTH NOTICE OF VIOLATIONS
FIFTH VIOLATION TICKET = SIXTH VIOLATION TICKET
FIFTH NOTICE = SIXTH NOTICE
FIFTH STOP WORK NOTICE = SIXTH STOP WORK NOTICE

# sixth to seventh
FF1023478 = FF1023494
FF1023495 = FF1023511
FF1023458 = FF1023474
FF1023462 = FF1023478
FF1023459 = FF1023475
FF1023460 = FF1023476
FF1023471 = FF1023487
FF1023470 = FF1023486
FF1038233 = FF1038234
FF1023465 = FF1023481
FF1023466 = FF1023482
FF1023467 = FF1023483
FF1023543 = FF1023544
FF1023554 = FF1023555
FF1023468 = FF1023484
MES1012231 = MES1012233
OL1023578 = OL1023582
FF1023580 = FF1023584
FF1023581 = FF1023585
FF1023579 = FF1023583
FF1023479 = FF1023495
SIXTH NOTICE OF VIOLATIONS = SEVENTH NOTICE OF VIOLATIONS
SIXTH VIOLATION TICKET = SEVENTH VIOLATION TICKET
SIXTH NOTICE = SEVENTH NOTICE
SIXTH STOP WORK NOTICE = SEVENTH STOP WORK NOTICE

# seventh to eighth
FF1023494 = FF1023510
FF1023511 = FF1023527
FF1023474 = FF1023490
FF1023478 = FF1023494
FF1023475 = FF1023491
FF1023476 = FF1023492
FF1023487 = FF1023503
FF1023486 = FF1023502
FF1038234 = FF1038235
FF1023481 = FF1023497
FF1023482 = FF1023498
FF1023483 = FF1023499
FF1023544 = FF1023545
FF1023555 = FF1023556
FF1023484 = FF1023500
MES1012233 = MES1012235
OL1023582 = OL1023586
FF1023584 = FF1023588
FF1023585 = FF1023589
FF1023583 = FF1023587
FF1023495 = FF1023511
SEVENTH NOTICE OF VIOLATIONS = EIGHTH NOTICE OF VIOLATIONS
SEVENTH VIOLATION TICKET = EIGHTH VIOLATION TICKET
SEVENTH NOTICE = EIGHTH NOTICE
SEVENTH STOP WORK NOTICE = EIGHTH STOP WORK NOTICE

# eighth to ninth
FF1023510 = FF1023526
FF1023490 = FF1023506
FF1023494 = FF1023510
FF1023491 = FF1023507
FF1023492 = FF1023508
FF1023503 = FF1023519
FF1023502 = FF1023518
FF1038235 = FF1038236
FF1023497 = FF1023513
FF1023498 = FF1023514
FF1023499 = FF1023515
FF1023545 = FF1023546
FF1023556 = FF1023557
FF1023500 = FF1023516
MES1012235 = MES1012237
OL1023586 = OL1023590
FF1023588 = FF1023592
FF1023589 = FF1023593
FF1023587 = FF1023591
FF1023511 = FF1023527
EIGHTH NOTICE OF VIOLATIONS = NINTH NOTICE OF VIOLATIONS
EIGHTH VIOLATION TICKET = NINTH VIOLATION TICKET
EIGHTH NOTICE = NINTH NOTICE
EIGHTH STOP WORK NOTICE = NINTH STOP WORK NOTICE

# ninth to tenth
FF1023506 = FF1023522
FF1023510 = FF1023526
FF1023507 = FF1023523
FF1023508 = FF1023524
FF1023519 = FF1023535
FF1023518 = FF1023534
FF1038236 = FF1038227
FF1023513 = FF1023529
FF1023514 = FF1023530
FF1023515 = FF1023531
FF1023546 = FF1023547
FF1023557 = FF1023558
FF1023516 = FF1023532
MES1012237 = MES1012239
OL1023590 = OL1023594
FF1023592 = FF1023596
FF1023593 = FF1023597
FF1023591 = FF1023595
NINTH NOTICE OF VIOLATIONS = TENTH NOTICE OF VIOLATIONS
NINTH VIOLATION TICKET = TENTH VIOLATION TICKET
NINTH NOTICE = TENTH NOTICE
NINTH STOP WORK NOTICE = TENTH STOP WORK NOTICE
"""

# Step 4: Parse the mappings into an ordered list of dictionaries
mappings = []
current_mapping = {}
for line in mapping_text.strip().splitlines():
    line = line.strip()
    if line.startswith('#'):
        if current_mapping:
            mappings.append(current_mapping.copy())
            current_mapping = {}
        continue
    parts = line.split('=')
    if len(parts) == 2:
        left = parts[0].strip().replace('\u200b', '')
        right = parts[1].strip().replace('\u200b', '')
        current_mapping[left] = right
if current_mapping:
    mappings.append(current_mapping.copy())

# Step 5: Load input from a separate file
with open('generate letters input.txt', 'r', encoding='utf-8') as f:
    input_text = f.read()

# Step 6: Function to replace tokens
def replace_tokens(text, mapping):
    pattern = re.compile('|'.join(re.escape(k) for k in sorted(mapping, key=len, reverse=True)))
    return pattern.sub(lambda match: mapping.get(match.group(0), match.group(0)), text)

# Step 7: Define output filenames
output_filenames = [
    "letter_version_second.txt",
    "letter_version_third.txt",
    "letter_version_fourth.txt",
    "letter_version_fifth.txt",
    "letter_version_sixth.txt",
    "letter_version_seventh.txt",
    "letter_version_eighth.txt",
    "letter_version_ninth.txt",
    "letter_version_tenth.txt",
]

# Step 8: Perform sequential replacements and generate output files
current_text = input_text
for i, mapping in enumerate(mappings):
    current_text = replace_tokens(current_text, mapping)
    output_path = os.path.join(output_directory, output_filenames[i])
    with open(output_path, 'w', encoding='utf-8') as f:
        f.write(current_text)
    print(f"Generated: '{output_path}' after applying the '{mapping_text.strip().splitlines()[i*12]}' mapping") # Added mapping name for clarity

print(f"Done. Ten versions of the letter have been generated in the '{output_directory}' directory.")