import re
import os

# Step 1: Define the output directory name
output_directory = "housing ticket"  # You can change this name here

# Step 2: Create the output directory if it doesn't exist
if not os.path.exists(output_directory):
    os.makedirs(output_directory)
    print(f"Created directory: '{output_directory}'")

# Step 3: Define the mapping sections
mapping_text = """
# first to second
FF1036151 = FF1036148
FF1036097 = FF1036100
FF1035911 = FF1035918
FF1035950 = FF1036071
FF1037963 = FF1037965
FF1035939 = FF1036060
FF1035940 = FF1036061
FF1035941 = FF1036062
FF1035952 = FF1036073
FF1036150 = FF1036151
FF1037926 = FF1035942
FF1035902 = FF1035943
FF1035944 = FF1036065
FF1035769 = FF1035770
FF1036104 = FF1036092
FF1035959 = FF1036080
FF1035957 = FF1036078
FF1035955 = FF1036076
FF1035945 = FF1036066
FF1035946 = FF1036067
FF1035956 = FF1036077
FF1035958 = FF1036079
FF1035953 = FF1036074
FF1035954 = FF1036075
FF1035789 = FF1035790
FF1035721 = FF1035722
FF1035735 = FF1035736
FF1035948 = FF1036069
FF1035947 = FF1036068
FF1035949 = FF1036070
FF1036059 = FF1036027
FF1035961 = FF1035960
FF1035805 = FF1035806
FF1035825 = FF1035826
FF1035815 = FF1035816
FF1035904 = FF1035905
FF1035695 = FF1035698
FF1035696 = FF1035699
MES1013230 = MES1013233
OL1035763 = OL1035761
FF1036138 = FF1036125
FF1035762 = FF1035760
FF1035803 = FF1035795
FF1036096 = FF1036097
FF1035951 = FF1036072
FIRST NOTICE OF VIOLATIONS = SECOND NOTICE OF VIOLATIONS
FIRST VIOLATION TICKET = SECOND VIOLATION TICKET
FIRST NOTICE = SECOND NOTICE

# second to third
FF1036148 = FF1036149
FF1036100 = FF1036099
FF1036071 = FF1036028
FF1037965 = FF1037964
FF1036060 = FF1036081
FF1036061 = FF1036083
FF1036062 = FF1036082
FF1036073 = FF1036030
FF1036151 = FF1036148
FF1035942 = FF1036063
FF1035943 = FF1036064
FF1036065 = FF1036086
FF1035770 = FF1035771
FF1036092 = FF1036095
FF1036080 = FF1036037
FF1036078 = FF1036035
FF1036076 = FF1036033
FF1036066 = FF1036087
FF1036067 = FF1036088
FF1036077 = FF1036034
FF1036079 = FF1036036
FF1036074 = FF1036031
FF1036075 = FF1036032
FF1035736 = FF1035737
FF1036069 = FF1036090
FF1036068 = FF1036089
FF1036070 = FF1036091
FF1036027 = FF1036026
FF1035960 = FF1035868
FF1035806 = FF1035807
FF1035826 = FF1035827
FF1035816 = FF1035817
FF1035905 = FF1035906
FF1035698 = FF1035700
FF1035699 = FF1035701
MES1013233 = MES1013235
OL1035761 = OL1035759
FF1036125 = FF1036133
FF1035760 = FF1035758
FF1035795 = FF1035804
FF1036097 = FF1036100
FF1036072 = FF1036029
SECOND NOTICE OF VIOLATIONS = THIRD NOTICE OF VIOLATIONS
SECOND VIOLATION TICKET = THIRD VIOLATION TICKET
SECOND NOTICE = THIRD NOTICE

# third to fourth
FF1036149 = FF1036146
FF1036099 = FF1036103
FF1036028 = FF1036049
FF1037964 = FF1037966
FF1036081 = FF1036038
FF1036083 = FF1036039
FF1036082 = FF1036040
FF1036030 = FF1036051
FF1036148 = FF1036149
FF1036063 = FF1036084
FF1036064 = FF1036085
FF1036086 = FF1036043
FF1035771 = FF1035772
FF1036095 = FF1036094
FF1036037 = FF1036058
FF1036035 = FF1036056
FF1036033 = FF1036054
FF1036087 = FF1036044
FF1036088 = FF1036045
FF1036034 = FF1036055
FF1036036 = FF1036057
FF1036031 = FF1036052
FF1036032 = FF1036053
FF1035737 = FF1035738
FF1036090 = FF1036047
FF1036089 = FF1036046
FF1036091 = FF1036048
FF1036026 = FF1035993
FF1035868 = FF1035836
FF1035807 = FF1035808
FF1035827 = FF1035828
FF1035817 = FF1035818
FF1035906 = FF1035907
FF1035700 = FF1035702
FF1035701 = FF1035703
MES1013235 = MES1013237
OL1035759 = OL1035757
FF1036133 = FF1036132
FF1035758 = FF1035756
FF1035804 = FF1035796
FF1036100 = FF1036099
FF1036029 = FF1036050
THIRD NOTICE OF VIOLATIONS = FOURTH NOTICE OF VIOLATIONS
THIRD VIOLATION TICKET = FOURTH VIOLATION TICKET
THIRD NOTICE = FOURTH NOTICE

# fourth to fifth
FF1036146 = FF1036147
FF1036103 = FF1036119
FF1036049 = FF1036006
FF1037966 = FF1037961
FF1036038 = FF1035994
FF1036039 = FF1035995
FF1036040 = FF1035996
FF1036051 = FF1036007
FF1036149 = FF1036146
FF1036084 = FF1036041
FF1036085 = FF1036042
FF1036043 = FF1035999
FF1035772 = FF1035773
FF1036094 = FF1036098
FF1036058 = FF1036014
FF1036056 = FF1036012
FF1036054 = FF1036010
FF1036044 = FF1036000
FF1036045 = FF1036001
FF1036055 = FF1036011
FF1036057 = FF1036013
FF1036052 = FF1036008
FF1036053 = FF1036009
FF1035738 = FF1035739
FF1036047 = FF1036003
FF1036046 = FF1036002
FF1036048 = FF1036004
FF1035836 = FF1035835
FF1035808 = FF1035809
FF1035828 = FF1035829
FF1035818 = FF1035819
FF1035907 = FF1035908
FF1035702 = FF1035704
FF1035703 = FF1035705
MES1013237 = MES1013239
OL1035757 = OL1035755
FF1036132 = FF1036131
FF1035756 = FF1035754
FF1035796 = FF1035797
FF1036099 = FF1036103
FF1036050 = FF1036005
FOURTH NOTICE OF VIOLATIONS = FIFTH NOTICE OF VIOLATIONS
FOURTH VIOLATION TICKET = FIFTH VIOLATION TICKET
FOURTH NOTICE = FIFTH NOTICE

# fifth to sixth
FF1036147 = FF1036136
FF1036119 = FF1036120
FF1036006 = FF1035962
FF1037961 = FF1037962
FF1035994 = FF1036015
FF1035995 = FF1036016
FF1035996 = FF1036017
FF1036007 = FF1035964
FF1036146 = FF1036147
FF1036041 = FF1035997
FF1036042 = FF1035998
FF1035999 = FF1036020
FF1035773 = FF1035774
FF1036098 = FF1036102
FF1036014 = FF1035971
FF1036012 = FF1035969
FF1036010 = FF1035967
FF1036000 = FF1036021
FF1036001 = FF1036022
FF1036011 = FF1035968
FF1036013 = FF1035970
FF1036008 = FF1035965
FF1036009 = FF1035966
FF1035739 = FF1035740
FF1036003 = FF1036024
FF1036002 = FF1036023
FF1036004 = FF1036025
FF1035809 = FF1035810
FF1035829 = FF1035830
FF1035819 = FF1035820
FF1035908 = FF1035910
FF1035704 = FF1035706
FF1035705 = FF1035707
MES1013239 = MES1013241
OL1035755 = OL1035753
FF1036131 = FF1036130
FF1035754 = FF1035752
FF1035797 = FF1035798
FF1036103 = FF1036119
FF1036005 = FF1035963
FIFTH NOTICE OF VIOLATIONS = SIXTH NOTICE OF VIOLATIONS
FIFTH VIOLATION TICKET = SIXTH VIOLATION TICKET
FIFTH NOTICE = SIXTH NOTICE

# sixth to seventh
FF1036136 = FF1036137
FF1036120 = FF1036123
FF1035962 = FF1035983
FF1037962 = FF1037968
FF1036015 = FF1035972
FF1036016 = FF1035973
FF1036017 = FF1035974
FF1035964 = FF1035985
FF1036147 = FF1036136
FF1035997 = FF1036018
FF1035998 = FF1036019
FF1036020 = FF1035977
FF1035774 = FF1035766
FF1036102 = FF1036101
FF1035971 = FF1035992
FF1035969 = FF1035990
FF1035967 = FF1035988
FF1036021 = FF1035978
FF1036022 = FF1035979
FF1035968 = FF1035989
FF1035970 = FF1035991
FF1035965 = FF1035986
FF1035966 = FF1035987
FF1035740 = FF1035741
FF1036024 = FF1035981
FF1036023 = FF1035980
FF1036025 = FF1035982
FF1035810 = FF1035811
FF1035830 = FF1035831
FF1035820 = FF1035821
FF1035910 = FF1035914
FF1035706 = FF1035708
FF1035707 = FF1035709
MES1013241 = MES1013243
OL1035753 = OL1035751
FF1036130 = FF1036129
FF1035752 = FF1035750
FF1035798 = FF1035799
FF1036119 = FF1036120
FF1035963 = FF1035984
SIXTH NOTICE OF VIOLATIONS = SEVENTH NOTICE OF VIOLATIONS
SIXTH VIOLATION TICKET = SEVENTH VIOLATION TICKET
SIXTH NOTICE = SEVENTH NOTICE

# seventh to eighth
FF1036137 = FF1036134
FF1036123 = FF1036124
FF1035983 = FF1035880
FF1037968 = FF1037969
FF1035972 = FF1035869
FF1035973 = FF1035870
FF1035974 = FF1035871
FF1035985 = FF1035882
FF1036136 = FF1036137
FF1036018 = FF1035975
FF1036019 = FF1035976
FF1035977 = FF1035874
FF1035766 = FF1035767
FF1036101 = FF1036118
FF1035992 = FF1035889
FF1035990 = FF1035887
FF1035988 = FF1035885
FF1035978 = FF1035875
FF1035979 = FF1035876
FF1035989 = FF1035886
FF1035991 = FF1035888
FF1035986 = FF1035883
FF1035987 = FF1035884
FF1035741 = FF1035742
FF1035981 = FF1035878
FF1035980 = FF1035877
FF1035982 = FF1035879
FF1035811 = FF1035812
FF1035831 = FF1035832
FF1035821 = FF1035822
FF1035914 = FF1035915
FF1035708 = FF1035710
FF1035709 = FF1035711
MES1013243 = MES1013245
OL1035751 = OL1035749
FF1036129 = FF1036128
FF1035750 = FF1035748
FF1035799 = FF1035800
FF1036120 = FF1036123
FF1035984 = FF1035881
SEVENTH NOTICE OF VIOLATIONS = EIGHTH NOTICE OF VIOLATIONS
SEVENTH VIOLATION TICKET = EIGHTH VIOLATION TICKET
SEVENTH NOTICE = EIGHTH NOTICE

# eighth to ninth
FF1036134 = FF1036135
FF1035880 = FF1035847
FF1037969 = FF1037967
FF1035869 = FF1035890
FF1035870 = FF1035891
FF1035871 = FF1035892
FF1035882 = FF1035849
FF1036137 = FF1036134
FF1035975 = FF1035872
FF1035976 = FF1035873
FF1035874 = FF1035895
FF1035767 = FF1035768
FF1036118 = FF1036121
FF1035889 = FF1035856
FF1035887 = FF1035854
FF1035885 = FF1035852
FF1035875 = FF1035896
FF1035876 = FF1035897
FF1035886 = FF1035853
FF1035888 = FF1035855
FF1035883 = FF1035850
FF1035884 = FF1035851
FF1035742 = FF1035743
FF1035878 = FF1035899
FF1035877 = FF1035898
FF1035879 = FF1035900
FF1035812 = FF1035813
FF1035832 = FF1035833
FF1035822 = FF1035823
FF1035915 = FF1035916
FF1035710 = FF1035712
FF1035711 = FF1035713
MES1013245 = MES1013247
OL1035749 = OL1035747
FF1036128 = FF1036127
FF1035748 = FF1035746
FF1035800 = FF1035801
FF1036123 = FF1036124
FF1035881 = FF1035848
EIGHTH NOTICE OF VIOLATIONS = NINTH NOTICE OF VIOLATIONS
EIGHTH VIOLATION TICKET = NINTH VIOLATION TICKET
EIGHTH NOTICE = NINTH NOTICE

# ninth to tenth
FF1035847 = FF1035837
FF1035890 = FF1035857
FF1035891 = FF1035858
FF1035892 = FF1035859
FF1035849 = FF1035839
FF1036134 = FF1036135
FF1035872 = FF1035893
FF1035873 = FF1035894
FF1035895 = FF1035862
FF1035768 = FF1035764
FF1036121 = FF1036122
FF1035856 = FF1035846
FF1035854 = FF1035844
FF1035852 = FF1035842
FF1035896 = FF1035863
FF1035897 = FF1035864
FF1035853 = FF1035843
FF1035855 = FF1035845
FF1035850 = FF1035840
FF1035851 = FF1035841
FF1035743 = FF1035744
FF1035899 = FF1035866
FF1035898 = FF1035865
FF1035900 = FF1035867
FF1035813 = FF1035814
FF1035833 = FF1035834
FF1035823 = FF1035824
FF1035916 = FF1035917
FF1035712 = FF1035714
FF1035713 = FF1035715
MES1013247 = MES1013249
FF1036127 = FF1036126
FF1035746 = FF1035745
FF1035801 = FF1035802
FF1035848 = FF1035838
NINTH NOTICE OF VIOLATIONS = TENTH NOTICE OF VIOLATIONS
NINTH VIOLATION TICKET = TENTH VIOLATION TICKET
NINTH NOTICE = TENTH NOTICE
"""

# Step 4: Parse the mappings into an ordered list of dictionaries
mappings = []
current_mapping = {}
for line in mapping_text.strip().splitlines():
    line = line.strip()
    if line.startswith('#'):
        if current_mapping:
            mappings.append(current_mapping.copy())
            current_mapping = {}
        continue
    parts = line.split('=')
    if len(parts) == 2:
        left = parts[0].strip().replace('\u200b', '')
        right = parts[1].strip().replace('\u200b', '')
        current_mapping[left] = right
if current_mapping:
    mappings.append(current_mapping.copy())

# Step 5: Load input from a separate file
with open('generate letters input.txt', 'r', encoding='utf-8') as f:
    input_text = f.read()

# Step 6: Function to replace tokens
def replace_tokens(text, mapping):
    pattern = re.compile('|'.join(re.escape(k) for k in sorted(mapping, key=len, reverse=True)))
    return pattern.sub(lambda match: mapping.get(match.group(0), match.group(0)), text)

# Step 7: Define output filenames
output_filenames = [
    "letter_version_second.txt",
    "letter_version_third.txt",
    "letter_version_fourth.txt",
    "letter_version_fifth.txt",
    "letter_version_sixth.txt",
    "letter_version_seventh.txt",
    "letter_version_eighth.txt",
    "letter_version_ninth.txt",
    "letter_version_tenth.txt",
]

# Step 8: Perform sequential replacements and generate output files
current_text = input_text
for i, mapping in enumerate(mappings):
    current_text = replace_tokens(current_text, mapping)
    output_path = os.path.join(output_directory, output_filenames[i])
    with open(output_path, 'w', encoding='utf-8') as f:
        f.write(current_text)
    print(f"Generated: '{output_path}' after applying the '{mapping_text.strip().splitlines()[i*12]}' mapping") # Added mapping name for clarity

print(f"Done. Ten versions of the letter have been generated in the '{output_directory}' directory.")