import re
import os

# Step 1: Define the output directory name
output_directory = "Zoning vio"  # You can change this name here

# Step 2: Create the output directory if it doesn't exist
if not os.path.exists(output_directory):
    os.makedirs(output_directory)
    print(f"Created directory: '{output_directory}'")

# Step 3: Define the mapping sections
mapping_text = """
# first to second
FF1023714 = FF1023729
FF1023730 = FF1023745
FF1023694 = FF1023709
FF1023695 = FF1023710
FF1023699 = FF1023714
FF1023696 = FF1023711
FF1023697 = FF1023712
FF1023706 = FF1023721
FF1023705 = FF1023720
FF1023703 = FF1023718
FF1023702 = FF1023717
FF1036872 = FF1036873
FF1023707 = FF1023722
FF1023767 = FF1023782
FF1023844 = FF1023845
FF1023855 = FF1023856
FF1023704 = FF1023719
OL1038222 = OL1023842
FF1023866 = FF1023870
FF1023867 = FF1023871
FF1023865 = FF1023869
FF1023715 = FF1023730
FF1037951 = FF1037952
FIRST NOTICE OF VIOLATIONS = SECOND NOTICE OF VIOLATIONS
FIRST VIOLATION TICKET = SECOND VIOLATION TICKET
FIRST NOTICE = SECOND NOTICE
FIRST STOP WORK NOTICE = SECOND STOP WORK NOTICE

# second to third
FF1023729 = FF1023744
FF1023745 = FF1023760
FF1023709 = FF1023725
FF1023710 = FF1023724
FF1023714 = FF1023729
FF1023711 = FF1023726
FF1023712 = FF1023727
FF1023721 = FF1023736
FF1023720 = FF1023735
FF1023718 = FF1023733
FF1023717 = FF1023732
FF1036873 = FF1036869
FF1023722 = FF1023737
FF1023782 = FF1023797
FF1023845 = FF1023846
FF1023856 = FF1023857
FF1023719 = FF1023734
OL1023842 = OL1038223
FF1023870 = FF1023873
FF1023871 = FF1023875
FF1023869 = FF1023874
FF1023730 = FF1023745
FF1037952 = FF1037953
SECOND NOTICE OF VIOLATIONS = THIRD NOTICE OF VIOLATIONS
SECOND VIOLATION TICKET = THIRD VIOLATION TICKET
SECOND NOTICE = THIRD NOTICE
SECOND STOP WORK NOTICE = THIRD STOP WORK NOTICE

# third to fourth
FF1023744 = FF1023759
FF1023760 = FF1023775
FF1023725 = FF1023739
FF1023724 = FF1023740
FF1023729 = FF1023744
FF1023726 = FF1023741
FF1023727 = FF1023742
FF1023736 = FF1023750
FF1023735 = FF1023749
FF1023733 = FF1023748
FF1023732 = FF1023747
FF1036869 = FF1036874
FF1023737 = FF1023752
FF1023797 = FF1023812
FF1023846 = FF1023847
FF1023857 = FF1023858
FF1023734 = FF1023751
OL1038223 = OL1023868
FF1023873 = FF1023878
FF1023875 = FF1023879
FF1023874 = FF1023877
FF1023745 = FF1023760
FF1037953 = FF1037954
THIRD NOTICE OF VIOLATIONS = FOURTH NOTICE OF VIOLATIONS
THIRD VIOLATION TICKET = FOURTH VIOLATION TICKET
THIRD NOTICE = FOURTH NOTICE
THIRD STOP WORK NOTICE = FOURTH STOP WORK NOTICE

# fourth to fifth
FF1023759 = FF1023774
FF1023775 = FF1023790
FF1023739 = FF1023754
FF1023740 = FF1023755
FF1023744 = FF1023759
FF1023741 = FF1023756
FF1023742 = FF1023757
FF1023750 = FF1023766
FF1023749 = FF1023765
FF1023748 = FF1023763
FF1023747 = FF1023762
FF1036874 = FF1036875
FF1023812 = FF1023827
FF1023847 = FF1023848
FF1023858 = FF1023859
FF1023751 = FF1023764
OL1023868 = OL1023872
FF1023878 = FF1023882
FF1023879 = FF1023883
FF1023877 = FF1023881
FF1023760 = FF1023775
FF1037954 = FF1037955
FOURTH NOTICE OF VIOLATIONS = FIFTH NOTICE OF VIOLATIONS
FOURTH VIOLATION TICKET = FIFTH VIOLATION TICKET
FOURTH NOTICE = FIFTH NOTICE
FOURTH STOP WORK NOTICE = FIFTH STOP WORK NOTICE

# fifth to sixth
FF1023774 = FF1023789
FF1023790 = FF1023805
FF1023754 = FF1023769
FF1023755 = FF1023770
FF1023759 = FF1023774
FF1023756 = FF1023771
FF1023757 = FF1023772
FF1023766 = FF1023781
FF1023765 = FF1023780
FF1023763 = FF1023778
FF1023762 = FF1023777
FF1036875 = FF1036876
FF1023848 = FF1023849
FF1023859 = FF1023860
FF1023764 = FF1023779
OL1023872 = OL1023876
FF1023882 = FF1023886
FF1023883 = FF1023887
FF1023881 = FF1023885
FF1023775 = FF1023790
FF1037955 = FF1037956
FIFTH NOTICE OF VIOLATIONS = SIXTH NOTICE OF VIOLATIONS
FIFTH VIOLATION TICKET = SIXTH VIOLATION TICKET
FIFTH NOTICE = SIXTH NOTICE
FIFTH STOP WORK NOTICE = SIXTH STOP WORK NOTICE

# sixth to seventh
FF1023789 = FF1023804
FF1023805 = FF1023820
FF1023769 = FF1023784
FF1023770 = FF1023785
FF1023774 = FF1023789
FF1023771 = FF1023786
FF1023772 = FF1023787
FF1023781 = FF1023796
FF1023780 = FF1023795
FF1023778 = FF1023793
FF1023777 = FF1023792
FF1036876 = FF1036870
FF1023849 = FF1023850
FF1023860 = FF1023861
FF1023779 = FF1023794
OL1023876 = OL1023880
FF1023886 = FF1023890
FF1023887 = FF1023891
FF1023885 = FF1023889
FF1023790 = FF1023805
FF1037956 = FF1037957
SIXTH NOTICE OF VIOLATIONS = SEVENTH NOTICE OF VIOLATIONS
SIXTH VIOLATION TICKET = SEVENTH VIOLATION TICKET
SIXTH NOTICE = SEVENTH NOTICE
SIXTH STOP WORK NOTICE = SEVENTH STOP WORK NOTICE

# seventh to eighth
FF1023804 = FF1023819
FF1023820 = FF1023835
FF1023784 = FF1023799
FF1023785 = FF1023800
FF1023789 = FF1023804
FF1023786 = FF1023801
FF1023787 = FF1023802
FF1023796 = FF1023811
FF1023795 = FF1023810
FF1023793 = FF1023808
FF1023792 = FF1023807
FF1036870 = FF1036871
FF1023850 = FF1023851
FF1023861 = FF1023862
FF1023794 = FF1023809
OL1023880 = OL1023884
FF1023890 = FF1023894
FF1023891 = FF1023895
FF1023889 = FF1023893
FF1023805 = FF1023820
FF1037957 = FF1037958
SEVENTH NOTICE OF VIOLATIONS = EIGHTH NOTICE OF VIOLATIONS
SEVENTH VIOLATION TICKET = EIGHTH VIOLATION TICKET
SEVENTH NOTICE = EIGHTH NOTICE
SEVENTH STOP WORK NOTICE = EIGHTH STOP WORK NOTICE

# eighth to ninth
FF1023819 = FF1023834
FF1023799 = FF1023814
FF1023800 = FF1023815
FF1023804 = FF1023819
FF1023801 = FF1023816
FF1023802 = FF1023817
FF1023811 = FF1023826
FF1023810 = FF1023825
FF1023808 = FF1023823
FF1023807 = FF1023822
FF1036871 = FF1036877
FF1023851 = FF1023852
FF1023862 = FF1023863
FF1023809 = FF1023824
OL1023884 = OL1023888
FF1023894 = FF1023898
FF1023895 = FF1023899
FF1023893 = FF1023897
FF1023820 = FF1023835
FF1037958 = FF1037959
EIGHTH NOTICE OF VIOLATIONS = NINTH NOTICE OF VIOLATIONS
EIGHTH VIOLATION TICKET = NINTH VIOLATION TICKET
EIGHTH NOTICE = NINTH NOTICE
EIGHTH STOP WORK NOTICE = NINTH STOP WORK NOTICE

# ninth to tenth
FF1023814 = FF1023829
FF1023815 = FF1023830
FF1023819 = FF1023834
FF1023816 = FF1023831
FF1023817 = FF1023832
FF1023826 = FF1023841
FF1023825 = FF1023840
FF1023823 = FF1023838
FF1023822 = FF1023837
FF1036877 = FF1036878
FF1023852 = FF1023853
FF1023863 = FF1023864
FF1023824 = FF1023839
OL1023888 = OL1023892
FF1023898 = FF1023902
FF1023899 = FF1023903
FF1023897 = FF1023901
FF1037959 = FF1037960
NINTH NOTICE OF VIOLATIONS = TENTH NOTICE OF VIOLATIONS
NINTH VIOLATION TICKET = TENTH VIOLATION TICKET
NINTH NOTICE = TENTH NOTICE
NINTH STOP WORK NOTICE = TENTH STOP WORK NOTICE
"""

# Step 4: Parse the mappings into an ordered list of dictionaries
mappings = []
current_mapping = {}
for line in mapping_text.strip().splitlines():
    line = line.strip()
    if line.startswith('#'):
        if current_mapping:
            mappings.append(current_mapping.copy())
            current_mapping = {}
        continue
    parts = line.split('=')
    if len(parts) == 2:
        left = parts[0].strip().replace('\u200b', '')
        right = parts[1].strip().replace('\u200b', '')
        current_mapping[left] = right
if current_mapping:
    mappings.append(current_mapping.copy())

# Step 5: Load input from a separate file
with open('generate letters input.txt', 'r', encoding='utf-8') as f:
    input_text = f.read()

# Step 6: Function to replace tokens
def replace_tokens(text, mapping):
    pattern = re.compile('|'.join(re.escape(k) for k in sorted(mapping, key=len, reverse=True)))
    return pattern.sub(lambda match: mapping.get(match.group(0), match.group(0)), text)

# Step 7: Define output filenames
output_filenames = [
    "letter_version_second.txt",
    "letter_version_third.txt",
    "letter_version_fourth.txt",
    "letter_version_fifth.txt",
    "letter_version_sixth.txt",
    "letter_version_seventh.txt",
    "letter_version_eighth.txt",
    "letter_version_ninth.txt",
    "letter_version_tenth.txt",
]

# Step 8: Perform sequential replacements and generate output files
current_text = input_text
for i, mapping in enumerate(mappings):
    current_text = replace_tokens(current_text, mapping)
    output_path = os.path.join(output_directory, output_filenames[i])
    with open(output_path, 'w', encoding='utf-8') as f:
        f.write(current_text)
    print(f"Generated: '{output_path}' after applying the '{mapping_text.strip().splitlines()[i*12]}' mapping") # Added mapping name for clarity

print(f"Done. Ten versions of the letter have been generated in the '{output_directory}' directory.")