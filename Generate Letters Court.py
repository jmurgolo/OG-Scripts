import re
import os

# Step 1: Define the output directory name
output_directory = "Housing Court"  # You can change this name here

# Step 2: Create the output directory if it doesn't exist
if not os.path.exists(output_directory):
    os.makedirs(output_directory)
    print(f"Created directory: '{output_directory}'")

# Step 3: Define the mapping sections
mapping_text = """
# first to second
FF1022537 = FF1022555
FF1022556 = FF1022573
FF1022540 = FF1022558
FF1022531 = FF1022549
FF1022519 = FF1022537
FF1022541 = FF1022559
FF1022530 = FF1022548
FF1022524 = FF1022542
FF1022560 = FF1022577
FF1022533 = FF1022551
FF1022532 = FF1022550
FF1022529 = FF1022547
FF1022517 = FF1022535
FF1022528 = FF1022546
FF1022543 = FF1022561
FF1022527 = FF1022545
FF1022518 = FF1022536
FF1022521 = FF1022539
FF1022534 = FF1022552
FF1022538 = FF1022556
FF1022544 = FF1022562
FIRST NOTICE OF VIOLATIONS = SECOND NOTICE OF VIOLATIONS
FIRST VIOLATION TICKET = SECOND VIOLATION TICKET
FIRST NOTICE = SECOND NOTICE
FIRST STOP WORK NOTICE = SECOND STOP WORK NOTICE

# second to third
FF1022555 = FF1022572
FF1022573 = FF1022592
FF1022558 = FF1022575
FF1022549 = FF1022567
FF1022537 = FF1022555
FF1022559 = FF1022576
FF1022548 = FF1022566
FF1022577 = FF1022596
FF1022550 = FF1022568
FF1022547 = FF1022565
FF1022535 = FF1022553
FF1022546 = FF1022564
FF1022561 = FF1022578
FF1022545 = FF1022563
FF1022536 = FF1022554
FF1022539 = FF1022557
FF1022552 = FF1022569
FF1022556 = FF1022573
FF1022562 = FF1022579
SECOND NOTICE OF VIOLATIONS = THIRD NOTICE OF VIOLATIONS
SECOND VIOLATION TICKET = THIRD VIOLATION TICKET
SECOND NOTICE = THIRD NOTICE
SECOND STOP WORK NOTICE = THIRD STOP WORK NOTICE

# third to fourth
FF1022572 = FF1022591
FF1022592 = FF1038239
FF1022575 = FF1022594
FF1022567 = FF1022584
FF1022555 = FF1022572
FF1022576 = FF1022595
FF1022566 = FF1022583
FF1022596 = FF1038243
FF1022568 = FF1022585
FF1022565 = FF1022582
FF1022553 = FF1022570
FF1022564 = FF1022581
FF1022578 = FF1022597
FF1022563 = FF1022580
FF1022554 = FF1022571
FF1022557 = FF1022574
FF1022569 = FF1022588
FF1022573 = FF1022592
FF1022579 = FF1022598
THIRD NOTICE OF VIOLATIONS = FOURTH NOTICE OF VIOLATIONS
THIRD VIOLATION TICKET = FOURTH VIOLATION TICKET
THIRD NOTICE = FOURTH NOTICE
THIRD STOP WORK NOTICE = FOURTH STOP WORK NOTICE

# fourth to fifth
FF1022591 = FF1038250
FF1038239 = FF1038258
FF1022594 = FF1038248
FF1022584 = FF1022603
FF1022572 = FF1022591
FF1022595 = FF1038249
FF1022583 = FF1022602
FF1038243 = FF1038256
FF1022585 = FF1022604
FF1022582 = FF1022601
FF1022570 = FF1022589
FF1022581 = FF1022600
FF1022597 = FF1038241
FF1022580 = FF1022599
FF1022571 = FF1022590
FF1022574 = FF1022593
FF1022588 = FF1038237
FF1022592 = FF1038239
FF1022598 = FF1038244
FOURTH NOTICE OF VIOLATIONS = FIFTH NOTICE OF VIOLATIONS
FOURTH VIOLATION TICKET = FIFTH VIOLATION TICKET
FOURTH NOTICE = FIFTH NOTICE
FOURTH STOP WORK NOTICE = FIFTH STOP WORK NOTICE

# fifth to sixth
FF1038250 = FF1038260
FF1038258 = FF1038272
FF1038248 = FF1038257
FF1022603 = FF1038246
FF1022591 = FF1038250
FF1038249 = FF1038266
FF1022602 = FF1038253
FF1038256 = FF1038271
FF1022604 = FF1038251
FF1022601 = FF1038252
FF1022589 = FF1038238
FF1022600 = FF1038240
FF1038241 = FF1038264
FF1022599 = FF1038247
FF1022590 = FF1038245
FF1022593 = FF1038242
FF1038237 = FF1038259
FF1038239 = FF1038258
FF1038244 = FF1038267
FIFTH NOTICE OF VIOLATIONS = SIXTH NOTICE OF VIOLATIONS
FIFTH VIOLATION TICKET = SIXTH VIOLATION TICKET
FIFTH NOTICE = SIXTH NOTICE
FIFTH STOP WORK NOTICE = SIXTH STOP WORK NOTICE

# sixth to seventh
FF1038260 = FF1038273
FF1038272 = FF1038301
FF1038257 = FF1038282
FF1038246 = FF1038265
FF1038250 = FF1038260
FF1038266 = FF1038280
FF1038253 = FF1038262
FF1038271 = FF1038299
FF1038251 = FF1038270
FF1038252 = FF1038263
FF1038238 = FF1038261
FF1038240 = FF1038269
FF1038264 = FF1038276
FF1038247 = FF1038268
FF1038245 = FF1038254
FF1038242 = FF1038255
FF1038259 = FF1038279
FF1038258 = FF1038272
FF1038267 = FF1038284
SIXTH NOTICE OF VIOLATIONS = SEVENTH NOTICE OF VIOLATIONS
SIXTH VIOLATION TICKET = SEVENTH VIOLATION TICKET
SIXTH NOTICE = SEVENTH NOTICE
SIXTH STOP WORK NOTICE = SEVENTH STOP WORK NOTICE

# seventh to eighth
FF1038273 = FF1038298
FF1038301 = FF1038316
FF1038282 = FF1038300
FF1038265 = FF1038287
FF1038260 = FF1038273
FF1038280 = FF1038291
FF1038262 = FF1038286
FF1038299 = FF1038326
FF1038270 = FF1038278
FF1038263 = FF1038281
FF1038261 = FF1038283
FF1038269 = FF1038285
FF1038276 = FF1038293
FF1038268 = FF1038275
FF1038254 = FF1038277
FF1038255 = FF1038274
FF1038279 = FF1038297
FF1038272 = FF1038301
FF1038284 = FF1038296
SEVENTH NOTICE OF VIOLATIONS = EIGHTH NOTICE OF VIOLATIONS
SEVENTH VIOLATION TICKET = EIGHTH VIOLATION TICKET
SEVENTH NOTICE = EIGHTH NOTICE
SEVENTH STOP WORK NOTICE = EIGHTH STOP WORK NOTICE

# eighth to ninth
FF1038298 = FF1038318
FF1038316 = FF1038340
FF1038300 = FF1038321
FF1038287 = FF1038288
FF1038273 = FF1038298
FF1038291 = FF1038317
FF1038286 = FF1038304
FF1038326 = FF1038332
FF1038278 = FF1038290
FF1038281 = FF1038292
FF1038283 = FF1038302
FF1038285 = FF1038289
FF1038293 = FF1038323
FF1038275 = FF1038303
FF1038277 = FF1038294
FF1038274 = FF1038295
FF1038297 = FF1038325
FF1038301 = FF1038316
FF1038296 = FF1038319
EIGHTH NOTICE OF VIOLATIONS = NINTH NOTICE OF VIOLATIONS
EIGHTH VIOLATION TICKET = NINTH VIOLATION TICKET
EIGHTH NOTICE = NINTH NOTICE
EIGHTH STOP WORK NOTICE = NINTH STOP WORK NOTICE

# ninth to tenth
FF1038318 = FF1038341
FF1038340 = FF1038358
FF1038321 = FF1038338
FF1038288 = FF1038331
FF1038298 = FF1038318
FF1038317 = FF1038339
FF1038304 = FF1038328
FF1038332 = FF1038361
FF1038290 = FF1038329
FF1038292 = FF1038324
FF1038302 = FF1038327
FF1038289 = FF1038320
FF1038323 = FF1038343
FF1038303 = FF1038330
FF1038294 = FF1038322
FF1038295 = FF1038315
FF1038316 = FF1038340
FF1038319 = FF1038344
NINTH NOTICE OF VIOLATIONS = TENTH NOTICE OF VIOLATIONS
NINTH VIOLATION TICKET = TENTH VIOLATION TICKET
NINTH NOTICE = TENTH NOTICE
NINTH STOP WORK NOTICE = TENTH STOP WORK NOTICE
"""

# Step 4: Parse the mappings into an ordered list of dictionaries
mappings = []
current_mapping = {}
for line in mapping_text.strip().splitlines():
    line = line.strip()
    if line.startswith('#'):
        if current_mapping:
            mappings.append(current_mapping.copy())
            current_mapping = {}
        continue
    parts = line.split('=')
    if len(parts) == 2:
        left = parts[0].strip().replace('\u200b', '')
        right = parts[1].strip().replace('\u200b', '')
        current_mapping[left] = right
if current_mapping:
    mappings.append(current_mapping.copy())

# Step 5: Load input from a separate file
with open('generate letters input.txt', 'r', encoding='utf-8') as f:
    input_text = f.read()

# Step 6: Function to replace tokens
def replace_tokens(text, mapping):
    pattern = re.compile('|'.join(re.escape(k) for k in sorted(mapping, key=len, reverse=True)))
    return pattern.sub(lambda match: mapping.get(match.group(0), match.group(0)), text)

# Step 7: Define output filenames
output_filenames = [
    "letter_version_second.txt",
    "letter_version_third.txt",
    "letter_version_fourth.txt",
    "letter_version_fifth.txt",
    "letter_version_sixth.txt",
    "letter_version_seventh.txt",
    "letter_version_eighth.txt",
    "letter_version_ninth.txt",
    "letter_version_tenth.txt",
]

# Step 8: Perform sequential replacements and generate output files
current_text = input_text
for i, mapping in enumerate(mappings):
    current_text = replace_tokens(current_text, mapping)
    output_path = os.path.join(output_directory, output_filenames[i])
    with open(output_path, 'w', encoding='utf-8') as f:
        f.write(current_text)
    print(f"Generated: '{output_path}' after applying the '{mapping_text.strip().splitlines()[i*12]}' mapping") # Added mapping name for clarity

print(f"Done. Ten versions of the letter have been generated in the '{output_directory}' directory.")