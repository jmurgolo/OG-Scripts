import re
import os

# Step 1: Define the output directory name
output_directory = "building vio"  # You can change this name here

# Step 2: Create the output directory if it doesn't exist
if not os.path.exists(output_directory):
    os.makedirs(output_directory)
    print(f"Created directory: '{output_directory}'")

# Step 3: Define the mapping sections
mapping_text = """
# first to second
FF1026536 = FF1026537
FF1026487 = FF1026494
FF1026474 = FF1026446
FF1026477 = FF1026450
FF1026478 = FF1026451
FF1026540 = FF1026536
FF1026473 = FF1026445
FF1026476 = FF1026448
FF1026479 = FF1026452
FF1026475 = FF1026447
FF1026480 = FF1026453
FF1026255 = FF1026256
FF1026482 = FF1026489
FF1026471 = FF1026443
FIRST NOTICE = SECOND NOTICE
FIRST NOTICE OF VIOLATIONS = SECOND NOTICE OF VIOLATIONS
FF1026233 = FF1026234
FF1026449 = FF1026442
FF1026386 = FF1026375
FF1026472 = FF1026444
First Ticket = Second Ticket
OL1026506 = OL1026515
FF1026518 = FF1026521
FF1026252 = FF1026251
FF1026282 = FF1026284
FF1026490 = FF1026487
FIRST VIOLATION TICKET = SECOND VIOLATION TICKET

# second to third
FF1026537 = FF1026532
FF1026494 = FF1026497
FF1026446 = FF1026461
FF1026450 = FF1026455
FF1026451 = FF1026454
FF1026536 = FF1026537
FF1026445 = FF1026460
FF1026448 = FF1026463
FF1026452 = FF1026456
FF1026447 = FF1026462
FF1026453 = FF1026457
FF1026256 = FF1026274
FF1026489 = FF1026486
FF1026443 = FF1026458
SECOND NOTICE = THIRD NOTICE
SECOND NOTICE OF VIOLATIONS = THIRD NOTICE OF VIOLATIONS
FF1026234 = FF1026235
FF1026442 = FF1026408
FF1026375 = FF1026360
FF1026444 = FF1026459
Second Ticket = Third Ticket
OL1026515 = OL1026516
FF1026521 = FF1026517
FF1026251 = FF1026250
FF1026284 = FF1026285
FF1026487 = FF1026494
SECOND VIOLATION TICKET = THIRD VIOLATION TICKET

# third to fourth
FF1026532 = FF1026533
FF1026497 = FF1026500
FF1026461 = FF1026412
FF1026455 = FF1026464
FF1026454 = FF1026465
FF1026537 = FF1026532
FF1026460 = FF1026411
FF1026463 = FF1026414
FF1026456 = FF1026466
FF1026462 = FF1026413
FF1026457 = FF1026467
FF1026274 = FF1026275
FF1026486 = FF1026493
FF1026458 = FF1026409
THIRD NOTICE = FOURTH NOTICE
THIRD NOTICE OF VIOLATIONS = FOURTH NOTICE OF VIOLATIONS
FF1026235 = FF1026236
FF1026408 = FF1026403
FF1026360 = FF1026313
FF1026459 = FF1026410
Third Ticket = Fourth Ticket
OL1026516 = OL1026514
FF1026517 = FF1026519
FF1026250 = FF1026249
FF1026285 = FF1026283
FF1026494 = FF1026497
THIRD VIOLATION TICKET = FOURTH VIOLATION TICKET

# fourth to fifth
FF1026533 = FF1026530
FF1026500 = FF1026499
FF1026412 = FF1026390
FF1026464 = FF1026404
FF1026465 = FF1026405
FF1026532 = FF1026533
FF1026411 = FF1026389
FF1026414 = FF1026392
FF1026466 = FF1026406
FF1026413 = FF1026391
FF1026467 = FF1026407
FF1026275 = FF1026276
FF1026493 = FF1026496
FF1026409 = FF1026387
FOURTH NOTICE = FIFTH NOTICE
FOURTH NOTICE OF VIOLATIONS = FIFTH NOTICE OF VIOLATIONS
FF1026236 = FF1026237
FF1026313 = FF1026308
FF1026410 = FF1026388
Fourth Ticket = Fifth Ticket
OL1026514 = OL1026513
FF1026519 = FF1026522
FF1026249 = FF1026248
FF1026283 = FF1026286
FF1026497 = FF1026500
FOURTH VIOLATION TICKET = FIFTH VIOLATION TICKET

# fifth to sixth
FF1026530 = FF1026531
FF1026499 = FF1026502
FF1026390 = FF1026400
FF1026404 = FF1026393
FF1026405 = FF1026394
FF1026533 = FF1026530
FF1026389 = FF1026397
FF1026392 = FF1026402
FF1026406 = FF1026395
FF1026391 = FF1026401
FF1026407 = FF1026396
FF1026276 = FF1026277
FF1026496 = FF1026495
FF1026387 = FF1026398
FIFTH NOTICE = SIXTH NOTICE
FIFTH NOTICE OF VIOLATIONS = SIXTH NOTICE OF VIOLATIONS
FF1026237 = FF1026238
FF1026388 = FF1026399
Fifth Ticket = Sixth Ticket
OL1026513 = OL1026512
FF1026522 = FF1026523
FF1026248 = FF1026247
FF1026286 = FF1026287
FF1026500 = FF1026499
FIFTH VIOLATION TICKET = SIXTH VIOLATION TICKET

# sixth to seventh
FF1026531 = FF1026528
FF1026502 = FF1026504
FF1026400 = FF1026383
FF1026393 = FF1026376
FF1026394 = FF1026377
FF1026530 = FF1026531
FF1026397 = FF1026382
FF1026402 = FF1026385
FF1026395 = FF1026378
FF1026401 = FF1026384
FF1026396 = FF1026379
FF1026277 = FF1026278
FF1026495 = FF1026498
FF1026398 = FF1026380
SIXTH NOTICE = SEVENTH NOTICE
SIXTH NOTICE OF VIOLATIONS = SEVENTH NOTICE OF VIOLATIONS
FF1026238 = FF1026239
FF1026399 = FF1026381
Sixth Ticket = Seventh Ticket
OL1026512 = OL1026511
FF1026523 = FF1026524
FF1026247 = FF1026246
FF1026287 = FF1026288
FF1026499 = FF1026502
SIXTH VIOLATION TICKET = SEVENTH VIOLATION TICKET

# seventh to eighth
FF1026528 = FF1026529
FF1026504 = FF1026507
FF1026383 = FF1026368
FF1026376 = FF1026361
FF1026377 = FF1026362
FF1026531 = FF1026528
FF1026382 = FF1026367
FF1026378 = FF1026363
FF1026384 = FF1026369
FF1026379 = FF1026364
FF1026278 = FF1026279
FF1026498 = FF1026501
FF1026380 = FF1026365
SEVENTH NOTICE = EIGHTH NOTICE
SEVENTH NOTICE OF VIOLATIONS = EIGHTH NOTICE OF VIOLATIONS
FF1026239 = FF1026240
FF1026381 = FF1026366
Seventh Ticket = Eighth Ticket
OL1026511 = OL1026510
FF1026524 = FF1026525
FF1026246 = FF1026245
FF1026288 = FF1026289
FF1026502 = FF1026504
SEVENTH VIOLATION TICKET = EIGHTH VIOLATION TICKET

# eighth to ninth
FF1026529 = FF1026520
FF1026368 = FF1026317
FF1026361 = FF1026371
FF1026362 = FF1026372
FF1026528 = FF1026529
FF1026367 = FF1026316
FF1026363 = FF1026373
FF1026369 = FF1026318
FF1026364 = FF1026374
FF1026279 = FF1026280
FF1026501 = FF1026503
FF1026365 = FF1026314
EIGHTH NOTICE = NINTH NOTICE
EIGHTH NOTICE OF VIOLATIONS = NINTH NOTICE OF VIOLATIONS
FF1026240 = FF1026241
FF1026366 = FF1026315
Eighth Ticket = Ninth Ticket
OL1026510 = OL1026509
FF1026525 = FF1026526
FF1026245 = FF1026244
FF1026289 = FF1026290
FF1026504 = FF1026507
EIGHTH VIOLATION TICKET = NINTH VIOLATION TICKET

# ninth to tenth
FF1026317 = FF1026295
FF1026371 = FF1026309
FF1026372 = FF1026310
FF1026529 = FF1026520
FF1026316 = FF1026294
FF1026373 = FF1026311
FF1026318 = FF1026296
FF1026374 = FF1026312
FF1026280 = FF1026281
FF1026503 = FF1026505
FF1026314 = FF1026292
NINTH NOTICE = TENTH NOTICE
NINTH NOTICE OF VIOLATIONS = TENTH NOTICE OF VIOLATIONS
FF1026241 = FF1026242
FF1026315 = FF1026293
Ninth Ticket = Tenth Ticket
OL1026509 = OL1026508
FF1026526 = FF1026527
FF1026244 = FF1026243
FF1026290 = FF1026291
NINTH VIOLATION TICKET = TENTH VIOLATION TICKET
"""

# Step 4: Parse the mappings into an ordered list of dictionaries
mappings = []
current_mapping = {}
for line in mapping_text.strip().splitlines():
    line = line.strip()
    if line.startswith('#'):
        if current_mapping:
            mappings.append(current_mapping.copy())
            current_mapping = {}
        continue
    parts = line.split('=')
    if len(parts) == 2:
        left = parts[0].strip().replace('\u200b', '')
        right = parts[1].strip().replace('\u200b', '')
        current_mapping[left] = right
if current_mapping:
    mappings.append(current_mapping.copy())

# Step 5: Load input from a separate file
with open('Generate - Original Letter.txt', 'r', encoding='utf-8') as f:
    input_text = f.read()

# Step 6: Function to replace tokens
def replace_tokens(text, mapping):
    pattern = re.compile('|'.join(re.escape(k) for k in sorted(mapping, key=len, reverse=True)))
    return pattern.sub(lambda match: mapping.get(match.group(0), match.group(0)), text)

# Step 7: Define output filenames
output_filenames = [
    "letter_version_second.txt",
    "letter_version_third.txt",
    "letter_version_fourth.txt",
    "letter_version_fifth.txt",
    "letter_version_sixth.txt",
    "letter_version_seventh.txt",
    "letter_version_eighth.txt",
    "letter_version_ninth.txt",
    "letter_version_tenth.txt",
]

# Step 8: Perform sequential replacements and generate output files
current_text = input_text
for i, mapping in enumerate(mappings):
    current_text = replace_tokens(current_text, mapping)
    output_path = os.path.join(output_directory, output_filenames[i])
    with open(output_path, 'w', encoding='utf-8') as f:
        f.write(current_text)
    print(f"Generated: '{output_path}' after applying the '{mapping_text.strip().splitlines()[i*12]}' mapping") # Added mapping name for clarity

print(f"Done. Ten versions of the letter have been generated in the '{output_directory}' directory.")