import re
import os

# Step 1: Define the output directory name
output_directory = "Building vio"  # You can change this name here

# Step 2: Create the output directory if it doesn't exist
if not os.path.exists(output_directory):
    os.makedirs(output_directory)
    print(f"Created directory: '{output_directory}'")

# Step 3: Define the mapping sections
mapping_text = """
# first to second
FF1038059 = FF1038148
FF1038058 = FF1038146
FF1038078 = FF1038081
FF1022397 = FF1038055
FF1038194 = FF1038056
FF1038591 = FF1038739
FF1022396 = FF1038050
FF1022398 = FF1038061
FF1022430 = FF1038059
FF1038066 = FF1038051
FF1022363 = FF1038057
FF1022417 = FF1038062
FF1022423 = FF1038058
FF1022394 = FF1038060
FF1038590 = FF1038740
FF1038063 = FF1038068
FF1022395 = FF1038053
OL1022364 = OL1038185
FF1022424 = FF1038132
FF1038589 = FF1038741
FF1022365 = FF1038166
FF1022366 = FF1038131
FF1038150 = FF1038078
FIRST NOTICE OF VIOLATIONS = SECOND NOTICE OF VIOLATIONS
FIRST VIOLATION TICKET = SECOND VIOLATION TICKET
FIRST NOTICE = SECOND NOTICE
FIRST STOP WORK NOTICE = SECOND STOP WORK NOTICE

# second to third
FF1038148 = FF1038069
FF1038081 = FF1038105
FF1038055 = FF1038145
FF1038056 = FF1038141
FF1038739 = FF1038742
FF1038050 = FF1038133
FF1038061 = FF1038134
FF1038059 = FF1038148
FF1038051 = FF1038086
FF1038062 = FF1038065
FF1038058 = FF1038146
FF1038060 = FF1038143
FF1038740 = FF1038749
FF1038068 = FF1038067
FF1038053 = FF1038140
OL1038185 = OL1038186
FF1038132 = FF1038142
FF1038741 = FF1038750
FF1038166 = FF1038144
FF1038131 = FF1038139
FF1038078 = FF1038081
SECOND NOTICE OF VIOLATIONS = THIRD NOTICE OF VIOLATIONS
SECOND VIOLATION TICKET = THIRD VIOLATION TICKET
SECOND NOTICE = THIRD NOTICE
SECOND STOP WORK NOTICE = THIRD STOP WORK NOTICE

# third to fourth
FF1038069 = FF1038077
FF1038105 = FF1038102
FF1038145 = FF1038075
FF1038141 = FF1038070
FF1038742 = FF1038751
FF1038133 = FF1038074
FF1038134 = FF1038149
FF1038148 = FF1038069
FF1038086 = FF1038156
FF1038065 = FF1038071
FF1038143 = FF1038072
FF1038749 = FF1038752
FF1038067 = FF1038076
FF1038140 = FF1038073
OL1038186 = OL1038187
FF1038142 = FF1038165
FF1038750 = FF1038753
FF1038144 = FF1038168
FF1038139 = FF1038167
FF1038081 = FF1038105
THIRD NOTICE OF VIOLATIONS = FOURTH NOTICE OF VIOLATIONS
THIRD VIOLATION TICKET = FOURTH VIOLATION TICKET
THIRD NOTICE = FOURTH NOTICE
THIRD STOP WORK NOTICE = FOURTH STOP WORK NOTICE

# fourth to fifth
FF1038077 = FF1038161
FF1038102 = FF1038100
FF1038075 = FF1038080
FF1038070 = FF1038084
FF1038751 = FF1038755
FF1038074 = FF1038079
FF1038149 = FF1038083
FF1038069 = FF1038077
FF1038156 = FF1038107
FF1038071 = FF1038085
FF1038072 = FF1038155
FF1038752 = FF1038754
FF1038076 = FF1038091
FF1038073 = FF1038082
OL1038187 = OL1038188
FF1038165 = FF1038173
FF1038753 = FF1038743
FF1038168 = FF1038172
FF1038167 = FF1038171
FF1038105 = FF1038102
FOURTH NOTICE OF VIOLATIONS = FIFTH NOTICE OF VIOLATIONS
FOURTH VIOLATION TICKET = FIFTH VIOLATION TICKET
FOURTH NOTICE = FIFTH NOTICE
FOURTH STOP WORK NOTICE = FIFTH STOP WORK NOTICE

# fifth to sixth
FF1038161 = FF1038097
FF1038100 = FF1038117
FF1038080 = FF1038093
FF1038084 = FF1038095
FF1038755 = FF1038757
FF1038079 = FF1038151
FF1038083 = FF1038092
FF1038077 = FF1038161
FF1038107 = FF1038087
FF1038085 = FF1038096
FF1038155 = FF1038162
FF1038754 = FF1038756
FF1038091 = FF1038183
FF1038082 = FF1038094
OL1038188 = OL1038189
FF1038173 = FF1038175
FF1038743 = FF1038744
FF1038172 = FF1038176
FF1038171 = FF1038174
FF1038102 = FF1038100
FIFTH NOTICE OF VIOLATIONS = SIXTH NOTICE OF VIOLATIONS
FIFTH VIOLATION TICKET = SIXTH VIOLATION TICKET
FIFTH NOTICE = SIXTH NOTICE
FIFTH STOP WORK NOTICE = SIXTH STOP WORK NOTICE

# sixth to seventh
FF1038097 = FF1038101
FF1038117 = FF1038164
FF1038093 = FF1038103
FF1038095 = FF1038098
FF1038757 = FF1038759
FF1038151 = FF1038088
FF1038092 = FF1038099
FF1038161 = FF1038097
FF1038087 = FF1038124
FF1038096 = FF1038104
FF1038162 = FF1038163
FF1038756 = FF1038760
FF1038183 = FF1038108
FF1038094 = FF1038106
OL1038189 = OL1038190
FF1038175 = FF1038179
FF1038744 = FF1038745
FF1038176 = FF1038177
FF1038174 = FF1038170
FF1038100 = FF1038117
SIXTH NOTICE OF VIOLATIONS = SEVENTH NOTICE OF VIOLATIONS
SIXTH VIOLATION TICKET = SEVENTH VIOLATION TICKET
SIXTH NOTICE = SEVENTH NOTICE
SIXTH STOP WORK NOTICE = SEVENTH STOP WORK NOTICE

# seventh to eighth
FF1038101 = FF1038121
FF1038103 = FF1038090
FF1038098 = FF1038111
FF1038759 = FF1038746
FF1038088 = FF1038153
FF1038099 = FF1038109
FF1038097 = FF1038101
FF1038124 = FF1038128
FF1038104 = FF1038157
FF1038163 = FF1038118
FF1038760 = FF1038761
FF1038108 = FF1038112
FF1038106 = FF1038110
OL1038190 = OL1038191
FF1038179 = FF1038169
FF1038745 = FF1038758
FF1038177 = FF1038178
FF1038170 = FF1038181
FF1038117 = FF1038164
SEVENTH NOTICE OF VIOLATIONS = EIGHTH NOTICE OF VIOLATIONS
SEVENTH VIOLATION TICKET = EIGHTH VIOLATION TICKET
SEVENTH NOTICE = EIGHTH NOTICE
SEVENTH STOP WORK NOTICE = EIGHTH STOP WORK NOTICE

# eighth to ninth
FF1038121 = FF1038113
FF1038090 = FF1038123
FF1038111 = FF1038158
FF1038746 = FF1038748
FF1038153 = FF1038154
FF1038109 = FF1038159
FF1038101 = FF1038121
FF1038157 = FF1038119
FF1038118 = FF1038126
FF1038761 = FF1038747
FF1038112 = FF1038120
FF1038110 = FF1038122
OL1038191 = OL1038192
FF1038169 = FF1038136
FF1038758 = FF1038762
FF1038178 = FF1038182
FF1038181 = FF1038180
EIGHTH NOTICE OF VIOLATIONS = NINTH NOTICE OF VIOLATIONS
EIGHTH VIOLATION TICKET = NINTH VIOLATION TICKET
EIGHTH NOTICE = NINTH NOTICE
EIGHTH STOP WORK NOTICE = NINTH STOP WORK NOTICE

# ninth to tenth
FF1038123 = FF1038115
FF1038158 = FF1038129
FF1038748 = FF1038763
FF1038154 = FF1038114
FF1038159 = FF1038130
FF1038121 = FF1038113
FF1038119 = FF1038116
FF1038747 = FF1038765
FF1038122 = FF1038127
OL1038192 = OL1038193
FF1038136 = FF1038135
FF1038762 = FF1038764
FF1038182 = FF1038138
FF1038180 = FF1038137
NINTH NOTICE OF VIOLATIONS = TENTH NOTICE OF VIOLATIONS
NINTH VIOLATION TICKET = TENTH VIOLATION TICKET
NINTH NOTICE = TENTH NOTICE
NINTH STOP WORK NOTICE = TENTH STOP WORK NOTICE
"""

# Step 4: Parse the mappings into an ordered list of dictionaries
mappings = []
current_mapping = {}
for line in mapping_text.strip().splitlines():
    line = line.strip()
    if line.startswith('#'):
        if current_mapping:
            mappings.append(current_mapping.copy())
            current_mapping = {}
        continue
    parts = line.split('=')
    if len(parts) == 2:
        left = parts[0].strip().replace('\u200b', '')
        right = parts[1].strip().replace('\u200b', '')
        current_mapping[left] = right
if current_mapping:
    mappings.append(current_mapping.copy())

# Step 5: Load input from a separate file
with open('generate letters input.txt', 'r', encoding='utf-8') as f:
    input_text = f.read()

# Step 6: Function to replace tokens
def replace_tokens(text, mapping):
    pattern = re.compile('|'.join(re.escape(k) for k in sorted(mapping, key=len, reverse=True)))
    return pattern.sub(lambda match: mapping.get(match.group(0), match.group(0)), text)

# Step 7: Define output filenames
output_filenames = [
    "letter_version_second.txt",
    "letter_version_third.txt",
    "letter_version_fourth.txt",
    "letter_version_fifth.txt",
    "letter_version_sixth.txt",
    "letter_version_seventh.txt",
    "letter_version_eighth.txt",
    "letter_version_ninth.txt",
    "letter_version_tenth.txt",
]

# Step 8: Perform sequential replacements and generate output files
current_text = input_text
for i, mapping in enumerate(mappings):
    current_text = replace_tokens(current_text, mapping)
    output_path = os.path.join(output_directory, output_filenames[i])
    with open(output_path, 'w', encoding='utf-8') as f:
        f.write(current_text)
    print(f"Generated: '{output_path}' after applying the '{mapping_text.strip().splitlines()[i*12]}' mapping") # Added mapping name for clarity

print(f"Done. Ten versions of the letter have been generated in the '{output_directory}' directory.")